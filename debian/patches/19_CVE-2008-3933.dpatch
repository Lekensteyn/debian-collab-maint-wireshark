#! /bin/sh /usr/share/dpatch/dpatch-run
## CVE-2008-3933
##
## All lines beginning with `## DP:' are a description of the patch.

@DPATCH@
--- trunk/epan/tvbuff.c	2008/07/08 16:32:56	25676
+++ wireshark-0.99.4/epan/tvbuff.c	2008/07/08 20:04:11	25677
@@ -2893,7 +2893,7 @@
 			if (flags & (1 << 3)) {
 				/* A null terminated filename */
 
-				while (*c != '\0') {
+				while ((c - compr) < comprlen && *c != '\0') {
 					c++;
 				}
 
@@ -2903,7 +2903,7 @@
 			if (flags & (1 << 4)) {
 				/* A null terminated comment */
 
-				while (*c != '\0') {
+				while ((c - compr) < comprlen && *c != '\0') {
 					c++;
 				}
 

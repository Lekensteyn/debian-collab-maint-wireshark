Description: Don't free uninitialized memory.
Forwarded: http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=35791
Author: Huzaifa Sidhpurwala of the Red Hat Security Response Team

Index: trunk/tshark.c
===================================================================
--- trunk/tshark.c	(revision 35790)
+++ trunk/tshark.c	(revision 35791)
@@ -2524,7 +2524,7 @@
   int          snapshot_length;
   wtap_dumper *pdh;
   int          err;
-  gchar        *err_info;
+  gchar        *err_info = NULL;
   gint64       data_offset;
   char         *save_file_string = NULL;
   gboolean     filtering_tap_listeners;
Index: trunk/wiretap/pcapng.c
===================================================================
--- trunk/wiretap/pcapng.c	(revision 35790)
+++ trunk/wiretap/pcapng.c	(revision 35791)
@@ -806,12 +806,14 @@
 		pcapng_debug2("pcapng_read_packet_block:cap_len %d is larger than packet_len %u.",
 		              wblock->data.packet.cap_len, wblock->data.packet.packet_len);
 		*err = WTAP_ERR_BAD_RECORD;
+		*err_info = strdup("pcapng_read_packet_block:cap_len is larger than packet_len");
 		return 0;
 	}
 	if (wblock->data.packet.cap_len > WTAP_MAX_PACKET_SIZE) {
 		pcapng_debug2("pcapng_read_packet_block:cap_len %d is larger than WTAP_MAX_PACKET_SIZE %u.",
 		              wblock->data.packet.cap_len, WTAP_MAX_PACKET_SIZE);
 		*err = WTAP_ERR_BAD_RECORD;
+		*err_info = strdup("pcapng_read_packet_block:cap_len is larger than WTAP_MAX_PACKET_SIZE");
 		return 0;
 	}
 	pcapng_debug3("pcapng_read_packet_block: packet data: packet_len %u captured_len %u interface_id %u",


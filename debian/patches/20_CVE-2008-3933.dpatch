#! /bin/sh /usr/share/dpatch/dpatch-run
## 20_CVE-2008-3933.dpatch by  <andete@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: No description.

@DPATCH@
diff -urNad lenny~/epan/tvbuff.c lenny/epan/tvbuff.c
--- lenny~/epan/tvbuff.c	2008-07-10 19:39:27.000000000 +0200
+++ lenny/epan/tvbuff.c	2008-09-15 21:27:59.000000000 +0200
@@ -2876,7 +2876,7 @@
 			if (flags & (1 << 3)) {
 				/* A null terminated filename */
 
-				while (*c != '\0') {
+				while ((c - compr) < comprlen && *c != '\0') {
 					c++;
 				}
 
@@ -2886,7 +2886,7 @@
 			if (flags & (1 << 4)) {
 				/* A null terminated comment */
 
-				while (*c != '\0') {
+				while ((c - compr) < comprlen && *c != '\0') {
 					c++;
 				}
 

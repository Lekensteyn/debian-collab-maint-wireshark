From be7df8480f7897ae61c381102157200d77140940 Mon Sep 17 00:00:00 2001
From: Michael Mann <mmann78@netscape.net>
Date: Sat, 26 Jan 2013 15:07:25 +0000
Subject: [PATCH 4/7] dcp-etsi dissector: new formula for rx_min Bug 8231
 (https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=8231)

svn path=/trunk/; revision=47295
---
 epan/dissectors/packet-dcp-etsi.c |    4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/epan/dissectors/packet-dcp-etsi.c b/epan/dissectors/packet-dcp-etsi.c
index f69e069..c646a08 100644
--- a/epan/dissectors/packet-dcp-etsi.c
+++ b/epan/dissectors/packet-dcp-etsi.c
@@ -273,9 +273,7 @@ dissect_pft_fec_detailed(tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree,
 
   decoded_size = fcount*plen;
   c_max = fcount*plen/(rsk+PFT_RS_P);  /* rounded down */
-  rx_min = c_max*rsk/plen;
-  if(rx_min*plen<c_max*rsk)
-    rx_min++;
+  rx_min = fcount - (c_max*PFT_RS_P/plen);
   if (fdx)
     new_tvb = process_reassembled_data (tvb, offset, pinfo,
                                         "Reassembled DCP (ETSI)",
-- 
1.7.10.4

